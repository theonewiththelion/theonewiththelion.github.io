<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Azure ETL: PowerBI - Jonathan de Jesus Portfolio</title><meta name="Description" content="My cool data portfolio site"><meta property="og:title" content="Azure ETL: PowerBI" />
<meta property="og:description" content="ETL Diagram from Austin API data to PowerBI Idea: Extract data from Austin, separate the information into three different tables, transform the data, upload it to Azure SQL and Visualize the information in PowerBI.
(Insert diagram)
List of Technology used on this project: List of skills used on this project are:
Visual Studio Python - Pandas, SQLAlchemy, Functions(I know, right?) Azure SQL PowerBI Data Modeling (basic) ETL Information: Setup Import Libraries Library from datetime import date, datetime from sqlalchemy import create_engine from sqlalchemy import * import urllib import json import requests import pandas as pd Create connection to database - Azure SQL Library #Azure Server information server = &#39;animalserver." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://theonewiththelion.github.io/posts/3post/" /><meta property="og:image" content="https://theonewiththelion.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-10T11:28:17-05:00" />
<meta property="article:modified_time" content="2022-09-10T11:28:17-05:00" /><meta property="og:site_name" content="My cool data portfolio site" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://theonewiththelion.github.io/logo.png"/>

<meta name="twitter:title" content="Azure ETL: PowerBI"/>
<meta name="twitter:description" content="ETL Diagram from Austin API data to PowerBI Idea: Extract data from Austin, separate the information into three different tables, transform the data, upload it to Azure SQL and Visualize the information in PowerBI.
(Insert diagram)
List of Technology used on this project: List of skills used on this project are:
Visual Studio Python - Pandas, SQLAlchemy, Functions(I know, right?) Azure SQL PowerBI Data Modeling (basic) ETL Information: Setup Import Libraries Library from datetime import date, datetime from sqlalchemy import create_engine from sqlalchemy import * import urllib import json import requests import pandas as pd Create connection to database - Azure SQL Library #Azure Server information server = &#39;animalserver."/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://theonewiththelion.github.io/posts/3post/" /><link rel="prev" href="https://theonewiththelion.github.io/posts/second_post/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Azure ETL: PowerBI",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/theonewiththelion.github.io\/posts\/3post\/"
        },"genre": "posts","wordcount":  574 ,
        "url": "https:\/\/theonewiththelion.github.io\/posts\/3post\/","datePublished": "2022-09-10T11:28:17-05:00","dateModified": "2022-09-10T11:28:17-05:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Jonathan de Jesus"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Jonathan de Jesus Portfolio">&gt; Portfolio</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/me/"> About Me </a><a class="menu-item" href="/posts/"> Posts &amp; Projects </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Jonathan de Jesus Portfolio">&gt; Portfolio</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/me/" title="">About Me</a><a class="menu-item" href="/posts/" title="">Posts &amp; Projects</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Azure ETL: PowerBI</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Jonathan de Jesus</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-09-10">2022-09-10</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;574 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;3 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#etl-diagram-from-austin-api-data-to-powerbi">ETL Diagram from Austin API data to PowerBI</a>
      <ul>
        <li><a href="#idea">Idea:</a></li>
        <li><a href="#list-of-technology-used-on-this-project">List of Technology used on this project:</a></li>
      </ul>
    </li>
    <li><a href="#etl-information">ETL Information:</a>
      <ul>
        <li><a href="#setup">Setup</a></li>
        <li><a href="#extraction">Extraction</a></li>
        <li><a href="#transformation">Transformation:</a></li>
        <li><a href="#load">Load:</a></li>
        <li><a href="#azure-sql">Azure SQL</a></li>
        <li><a href="#visualization-powerbi">Visualization: PowerBI</a></li>
        <li><a href="#end">END</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="etl-diagram-from-austin-api-data-to-powerbi">ETL Diagram from Austin API data to PowerBI</h2>
<h3 id="idea">Idea:</h3>
<p>Extract data from <a href="https://data.austintexas.gov/Health-and-Community-Services/Austin-Animal-Center-Outcomes/9t4d-g238" target="_blank" rel="noopener noreffer ">Austin</a>, separate the information into three different tables, transform the data, upload it to Azure SQL and Visualize the information in PowerBI.</p>
<p>(Insert diagram)</p>
<h3 id="list-of-technology-used-on-this-project">List of Technology used on this project:</h3>
<p>List of skills used on this project are:</p>
<ul>
<li>Visual Studio</li>
<li>Python - Pandas, SQLAlchemy, Functions(I know, right?)</li>
<li>Azure SQL</li>
<li>PowerBI</li>
<li>Data Modeling (basic)</li>
</ul>
<h2 id="etl-information">ETL Information:</h2>
<h3 id="setup">Setup</h3>
<ol>
<li>
<p>Import Libraries
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Library<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> date, datetime
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sqlalchemy <span style="color:#f92672">import</span> create_engine
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sqlalchemy <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span></code></pre></div></div>
        </div>
    </div></p>
</li>
<li>
<p>Create connection to database - Azure SQL
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Library<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#Azure Server information</span>
</span></span><span style="display:flex;"><span>server <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;animalserver.database.windows.net&#39;</span>
</span></span><span style="display:flex;"><span>database <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;animaldatabase&#39;</span>
</span></span><span style="display:flex;"><span>username <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;azureuser&#39;</span>
</span></span><span style="display:flex;"><span>password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Azure_Password&#39;</span> 
</span></span><span style="display:flex;"><span>driver<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;{ODBC Driver 18 for SQL Server}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Azure Server Information Parameters</span>
</span></span><span style="display:flex;"><span>params <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>parse<span style="color:#f92672">.</span>quote_plus(<span style="color:#e6db74">&#39;DRIVER=&#39;</span><span style="color:#f92672">+</span>driver<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;;SERVER=tcp:&#39;</span><span style="color:#f92672">+</span>server<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;;PORT=1433;DATABASE=&#39;</span><span style="color:#f92672">+</span>database<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;;UID=&#39;</span><span style="color:#f92672">+</span>username<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;;PWD=&#39;</span><span style="color:#f92672">+</span> password)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Learn how to create the connection</span>
</span></span><span style="display:flex;"><span>conn_str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;mssql+pyodbc:///?odbc_connect=</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(params)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Create Engine - VERY IMPORTANT</span>
</span></span><span style="display:flex;"><span>engine_azure <span style="color:#f92672">=</span> create_engine(conn_str,echo<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Create metadata object, help at the creation of tables</span>
</span></span><span style="display:flex;"><span>meta <span style="color:#f92672">=</span> MetaData()
</span></span></code></pre></div></div>
        </div>
    </div></p>
</li>
</ol>
<h3 id="extraction">Extraction</h3>
<ol>
<li>Extract data from API and save into three dataframes; names, dates, &amp; outcomes.
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Extraction<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#Extraction    </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Extract data from API</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Save information into dataframe called names    </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">api_extraction_names</span>():
</span></span><span style="display:flex;"><span>    animal_shelter_api <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;https://data.austintexas.gov/resource/9t4d-g238.json?$limit=10&#34;</span>)
</span></span><span style="display:flex;"><span>    animal_shelter_table <span style="color:#f92672">=</span> animal_shelter_api<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>    json<span style="color:#f92672">.</span>loads(animal_shelter_table)
</span></span><span style="display:flex;"><span>    animal_shelter_table <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_json(animal_shelter_table)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    names <span style="color:#f92672">=</span> animal_shelter_table[[<span style="color:#e6db74">&#34;animal_id&#34;</span>,<span style="color:#e6db74">&#34;name&#34;</span>,<span style="color:#e6db74">&#34;animal_type&#34;</span>,<span style="color:#e6db74">&#34;breed&#34;</span>,<span style="color:#e6db74">&#34;color&#34;</span>]]
</span></span><span style="display:flex;"><span>    print(names<span style="color:#f92672">.</span>head())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> names
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Extract data from API</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Save information into dataframe called dates    </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">api_extraction_dates</span>():
</span></span><span style="display:flex;"><span>    animal_shelter_api <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;https://data.austintexas.gov/resource/9t4d-g238.json?$limit=10&#34;</span>)
</span></span><span style="display:flex;"><span>    animal_shelter_table <span style="color:#f92672">=</span> animal_shelter_api<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>    json<span style="color:#f92672">.</span>loads(animal_shelter_table)
</span></span><span style="display:flex;"><span>    animal_shelter_table <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_json(animal_shelter_table)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dates <span style="color:#f92672">=</span> animal_shelter_table[[<span style="color:#e6db74">&#34;animal_id&#34;</span>,<span style="color:#e6db74">&#34;datetime&#34;</span>,<span style="color:#e6db74">&#34;monthyear&#34;</span>,<span style="color:#e6db74">&#34;date_of_birth&#34;</span>]]
</span></span><span style="display:flex;"><span>    print(dates<span style="color:#f92672">.</span>head())
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> dates
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Extract data from API</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Save information into dataframe called outcome    </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">api_extraction_outcome</span>():
</span></span><span style="display:flex;"><span>    animal_shelter_api <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;https://data.austintexas.gov/resource/9t4d-g238.json?$limit=10&#34;</span>)
</span></span><span style="display:flex;"><span>    animal_shelter_table <span style="color:#f92672">=</span> animal_shelter_api<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>    json<span style="color:#f92672">.</span>loads(animal_shelter_table)
</span></span><span style="display:flex;"><span>    animal_shelter_table <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_json(animal_shelter_table)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    outcome <span style="color:#f92672">=</span> animal_shelter_table[[<span style="color:#e6db74">&#34;animal_id&#34;</span>,<span style="color:#e6db74">&#34;outcome_type&#34;</span>,<span style="color:#e6db74">&#34;sex_upon_outcome&#34;</span>,<span style="color:#e6db74">&#34;age_upon_outcome&#34;</span>]]
</span></span><span style="display:flex;"><span>    print(outcome<span style="color:#f92672">.</span>head())
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> outcome
</span></span></code></pre></div></div>
        </div>
    </div></li>
</ol>
<h3 id="transformation">Transformation:</h3>
<ol>
<li>Transform column &ldquo;monthyear&rdquo;, split values into two new columns</li>
<li>Transform column &ldquo;date&rdquo;, split information into 3 new columns</li>
<li>Transform column &ldquo;date of birth&rdquo;, take the information on the left of “T”</li>
<li>delete columns; &ldquo;Date time&rdquo; and &ldquo;monthyear&rdquo;
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Transform<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#Transformation</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Separate values from column monthyear into two new columns date and date time, information from dates dataframe (not yet a table)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Separate the column date, into 3 new columns date year, date motnh, date day</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#separate the colum date of birth and accepting only everything before the value &#34;T&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Delete the columns datetime and monthyear</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">transformation_dates</span>(dates):
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#Documentation https://learn.microsoft.com/en-us/sql/machine-learning/data-exploration/python-dataframe-pandas?view=sql-server-ver16</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#documentation - https://datascienceparichay.com/article/pandas-split-column-by-delimiter/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#take month year and separrate the values</span>
</span></span><span style="display:flex;"><span>    dates[[<span style="color:#e6db74">&#39;Date&#39;</span>, <span style="color:#e6db74">&#39;date_time&#39;</span>]] <span style="color:#f92672">=</span> dates[<span style="color:#e6db74">&#39;monthyear&#39;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;T&#39;</span>, expand <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    dates[[<span style="color:#e6db74">&#39;date_year&#39;</span>, <span style="color:#e6db74">&#39;date_month&#39;</span>, <span style="color:#e6db74">&#39;date_day&#39;</span>]] <span style="color:#f92672">=</span> dates[<span style="color:#e6db74">&#39;Date&#39;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;-&#39;</span>, expand <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#Documentation</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#https://stackoverflow.com/questions/40705480/python-pandas-remove-everything-after-a-delimiter-in-a-string</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#Separate the field date of birth after the value &#34;T&#34;</span>
</span></span><span style="display:flex;"><span>    dates[<span style="color:#e6db74">&#39;date_of_birth&#39;</span>] <span style="color:#f92672">=</span> dates[<span style="color:#e6db74">&#39;date_of_birth&#39;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;T&#39;</span>)<span style="color:#f92672">.</span>str[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#drop &#34;datetime&#34;, &#34;monthyear&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#extract_dates.drop([&#39;datetime&#39;,&#39;monthyear&#39;], axis=1)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">del</span> dates[<span style="color:#e6db74">&#39;datetime&#39;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">del</span> dates[<span style="color:#e6db74">&#39;monthyear&#39;</span>]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    print(dates)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> dates
</span></span></code></pre></div></div>
        </div>
    </div></li>
</ol>
<h3 id="load">Load:</h3>
<ol>
<li>Create three tables in Azure SQL</li>
<li>Load records into new tables using the three dataframes used in the extraction step
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Table creation &amp; data load<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_animal_shelter</span>(names, outcome, dates):
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    p_names <span style="color:#f92672">=</span> Table(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;p_names&#39;</span>, meta,
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;animal_id&#39;</span>, String(<span style="color:#ae81ff">20</span>), primary_key <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>),
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;name&#39;</span>, String),
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;animal_type&#39;</span>, String),
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;breed&#39;</span>, String),
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;color&#39;</span>, String),
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    p_dates <span style="color:#f92672">=</span> Table(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;p_dates&#39;</span>, meta,
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;animal_id&#39;</span>, String(<span style="color:#ae81ff">20</span>), primary_key <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>),
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;datetime&#39;</span>, DateTime),
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;monthyear&#39;</span>, String),
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;date_of_birth&#39;</span>, String)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    p_outcome <span style="color:#f92672">=</span> Table(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;p_outcome&#39;</span>, meta,
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;animal_id&#39;</span>, String(<span style="color:#ae81ff">20</span>), primary_key <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>),
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;outcome_type&#39;</span>, String),
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;sex_upon_outcome&#39;</span>, String),
</span></span><span style="display:flex;"><span>        Column(<span style="color:#e6db74">&#39;age_upon_outcome&#39;</span>, String)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    meta<span style="color:#f92672">.</span>create_all(engine_azure)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Tables created&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#Will update this with a function later on</span>
</span></span><span style="display:flex;"><span>    names<span style="color:#f92672">.</span>to_sql(<span style="color:#e6db74">&#39;p_names&#39;</span>, con<span style="color:#f92672">=</span>engine_azure, if_exists<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;replace&#39;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Table names Populated&#34;</span>)
</span></span><span style="display:flex;"><span>    outcome<span style="color:#f92672">.</span>to_sql(<span style="color:#e6db74">&#39;p_dates&#39;</span>, con<span style="color:#f92672">=</span>engine_azure, if_exists<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;replace&#39;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Table dates Populated&#34;</span>)
</span></span><span style="display:flex;"><span>    dates<span style="color:#f92672">.</span>to_sql(<span style="color:#e6db74">&#39;p_outcome&#39;</span>, con<span style="color:#f92672">=</span>engine_azure, if_exists<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;replace&#39;</span>, index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Table outcome Populated&#34;</span>)
</span></span></code></pre></div></div>
        </div>
    </div></li>
</ol>
<h3 id="azure-sql">Azure SQL</h3>
<ol>
<li>See list of tables and columns</li>
<li>See Query and results
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="../azure_sql.png"
        data-srcset="../azure_sql.png, ../azure_sql.png 1.5x, ../azure_sql.png 2x"
        data-sizes="auto"
        alt="../azure_sql.png"
        title="../azure_sql.png" /></li>
</ol>
<h3 id="visualization-powerbi">Visualization: PowerBI</h3>
<ol>
<li>
<p>Dashboard present:</p>
<ul>
<li>Total of records</li>
<li>Distribution of animal type</li>
<li>Type of animal and their breed</li>
<li>Reason of leaving shelter</li>
<li>Sex outcome when leaving the shelter</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="../Visualization1.png"
        data-srcset="../Visualization1.png, ../Visualization1.png 1.5x, ../Visualization1.png 2x"
        data-sizes="auto"
        alt="../Visualization1.png"
        title="../Visualization1.png" /></p>
</li>
<li>
<p>Select animal type to filter dashboard</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="../Visualization2.png"
        data-srcset="../Visualization2.png, ../Visualization2.png 1.5x, ../Visualization2.png 2x"
        data-sizes="auto"
        alt="../Visualization2.png"
        title="../Visualization2.png" /></p>
</li>
</ol>
<h3 id="end">END</h3>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2022-09-10</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://theonewiththelion.github.io/posts/3post/" data-title="Azure ETL: PowerBI"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://theonewiththelion.github.io/posts/3post/"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://theonewiththelion.github.io/posts/3post/" data-title="Azure ETL: PowerBI"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://theonewiththelion.github.io/posts/3post/" data-title="Azure ETL: PowerBI"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://theonewiththelion.github.io/posts/3post/" data-title="Azure ETL: PowerBI"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/second_post/" class="prev" rel="prev" title="Basic ETL using Python, Big Query, Data Studio &amp; Airflow"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Basic ETL using Python, Big Query, Data Studio & Airflow</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.101.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Jonathan de Jesus Azor</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
